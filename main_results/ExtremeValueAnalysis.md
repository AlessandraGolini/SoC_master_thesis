# Extreme Value Analysis
## Univariate EVA
### Block Maxima - Empirical return periods
Following the Block Maxima approach (Coles, 2001), the observation record is here divided into non-overlapping periods of equal length and restricts attention to the maximum observation in each block. The resulting series of annual maxima is then fitted with the GEV distribution, allowing the estimation for return levels, defined as quantiles corresponding to specidic return periods. In this way, observed extremes are associated with probabilities, and extrapolation beyond the observed record becomes possible. It should be said, however, that while GEV distribution provides the theoretical foundation for modeling block maxima, its derivation assumes underlying stationarity. Coles (2001, §6) emphasizes that environmental processes rarely satisfy this assumption due to seasonal cycles and long-term trends. In fact, non-stationary time series are characterized by statistical properties that vary in time due to changes in the dynamic system (Mentaschi et al., 2016). As pointed out by Coles (2001), a general theory about non-stationary extreme value analysis (EVA) has not been formulated. Instead, different methodologies has been developed to analyze the extreme values in series that do not respect the statioarity assumption: from the expression of extreme value distribution parameters as time-varying parametric functions to model extremes of the non-stationary series, to the "stationary on slice" method, which divides those series into quasi-stationary and apply the stationary theory to each slice. In this study, the method used is the one proposed by Mentaschi et al. (2016): the transformed-stationary (TS) extreme value methodology. This approach consists of (i) transforming a non-stationary time series into a stationary series, (ii) performing a stationary EVA, and (iii) reverse transforming the resulting extreme value distribution into a time-dependent one.

In practice, the data here are divided into annual blocks, from which only the **annual maximum** value is considered, creating a shorter series of 12 values for 2010-2021 (1). The **GEV distribution is then fitted to these annual maxima** (2), with shape, location and scale parameters estimated through maxima likelihood estimation (MLE). Then, the return periods are computed as the reciprocal of exceedance probability, T = 1/p. The corresponding return level (3) q = 1 - 1/T is the quantile of the fitted GEV distribution that is exceeded with probability 1/T in any given year (Coles, 2001, §3.2).

In the code, once the GEV parameters are estimated, each observed annual maximum is assigned to an empirical return period using the Weibull plotting position (4): Temp = (n+1)/m, where n is the number of annual maxima and m is the rank of the maximum (from the largest = 1, to the smallest = n). At the same time, the fitted GEV is used to compute the theoretical return level curve across a smooth grid of return periods up to a safe maximum (≈3× record length).

Lastly, the comparison of the empirical estimates from data (points) with the fitted model (curve) is here paralelly proposed for both the raw time series and the detrended anomalies.

<img width="1189" height="397" alt="image" src="https://github.com/user-attachments/assets/fc2fe1f1-1c93-4fab-9226-33164c1d9611" />

Given the very short block maxima series, with only 12 years of data, the Maximum Likelihood Estimation method to estiamte the GEV parameters is very unstable. This is evident in the Volta Estuary River dicharge Return Levels for raw data: here the GEV curve explodes upwards very fast, wich is an unrealistic extrapolation.

Therefore, for short records such as this one, it is convinent to use Probability Weighted Moments (or L-moments), which is a much more robust method with short hydrological recors, and which produces more stable and realistic return levels.

<img width="1189" height="397" alt="image" src="https://github.com/user-attachments/assets/a7865918-9a89-4b51-9331-5a8f6075a972" />

Both panels show that the GEV estimate with L-moments provides a relatively more stable and theoretically consistent fit. However, the GEV curve is estimated here on an extremely small sample, since the dataset spans only over 12 years (2010-2021). The Block Maxima approach, then, implieas a significant loss of information, since it only uses annual maxima, ignoring all other extreme events that might happen in the same year. In small datasets, as the one in exam, this means wasting great part of the information contained in the series. This highly limits the GEV capability to well represent the tail distribution of extremes, leading to eventual underestimates or overestimates of the return periods, expecially for the longer ones (>10 years). To avoid this limit, and estimate return periods of 15-30 years in a robust way, it is convinient to consider another extreme analysis method.
